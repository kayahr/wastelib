<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>wastelib</title>
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.js" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">wastelib</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
				<li>
					<a href="globals.html">Globals</a>
				</li>
			</ul>
			<h1> wastelib</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<h1 id="wastelib">wastelib</h1>
				<p>A JavaScript library (Written in <a href="https://www.typescriptlang.org/">TypeScript</a>) for reading the assets of the game <a href="https://en.wikipedia.org/wiki/Wasteland_(video_game)">Wasteland</a>. Can be used in web-based
					or Node.js applications to easily parse all the images, animations, maps and other game data from the original
				Wasteland files.</p>
				<h2 id="todo">TODO</h2>
				<p>This library is currently under development and the following features are not yet implemented:</p>
				<ul>
					<li>Read game data (Maps, shop item lists, savegame)</li>
					<li>Write unit tests</li>
				</ul>
				<h2 id="build">Build</h2>
				<p>To build the project simply run <code>npm install</code>.</p>
				<p>This downloads the dependencies and then compiles the typescript sources in the <code>src</code> directory to JavaScript in the <code>lib</code> directory for usage in Node.js applications.</p>
				<p>It also creates a UMD bundle <code>lib/wastelib.js</code> which can be used in web applications.</p>
				<h2 id="usage">Usage</h2>
				<h3 id="web-">Web:</h3>
				<p>Copy the <code>wastelib.js</code> bundle from the <code>lib</code> directory to your website and include it. It provides the <code>wastelib</code>
				namespace with all the classes and functions of the library.</p>
				<h3 id="node-js-">Node.js:</h3>
				<p>Install wastelib as a standard NPM dependency into your NPM project:</p>
				<pre><code class="lang-sh">npm install --save wastelib
</code></pre>
				<p>And then simply require it:</p>
				<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> wastelib = <span class="hljs-built_in">require</span>(<span class="hljs-string">"wastelib"</span>);
<span class="hljs-comment">// Use wastelib.EndingPlayer class for example</span>
</code></pre>
				<p>You can also use ES6 imports if you are using <em>TypeScript</em> or some other compiler supporting it::</p>
				<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> { Ending, EndingPlayer } <span class="hljs-keyword">from</span> <span class="hljs-string">"wastelib"</span>;
</code></pre>
				<h2 id="canvas-api-and-node-js">Canvas API and Node.js</h2>
				<p><em>wastelib</em> uses the Canvas API for generating image output so a Node.js application benefits from using <a href="https://www.npmjs.com/package/canvas">node-canvas</a>.
					But this is not a requirement. Without the Canvas API you simply can&#39;t use the various <code>toCanvas()</code> and <code>toImage()</code>
					methods but you can still parse the Wasteland assets and manually convert them into whatever image format you like by
				calling <code>getWidth()</code>, <code>getHeight()</code> and <code>getColor(x, y)</code> methods.</p>
				<h2 id="parsing-assets">Parsing assets</h2>
				<p>There are classes for each asset type of the game:</p>
				<ul>
					<li><code>Cursors</code> - For parsing the mouse cursor images from the <code>CURS</code> file.</li>
					<li><code>Ending</code> - For parsing the end animation from the <code>END.CPA</code> file.</li>
					<li><code>Font</code> - For parsing the color font from the <code>COLORF.FNT</code> file.</li>
					<li><code>Portraits</code> - For parsing the portrait animations from the <code>ALLPICS1</code> and <code>ALLPICS2</code> files.</li>
					<li><code>Sprites</code> - For parsing the sprites from the <code>IC0_9.WLF</code> and <code>MASKS.WLF</code> files.</li>
					<li><code>Tilesets</code> - For parsing the tilesets from the <code>ALLHTDS1</code> and <code>ALLHTDS2</code> files.</li>
					<li><code>Title</code> - For parsing the title image from the <code>TITLE.PIC</code> file.</li>
				</ul>
				<p>There are always two types of static methods to parse the files. The <code>fromBlob()</code> (and/or <code>fromBlobs()</code>) method
					can be used with <code>Blob</code> or <code>File</code> objects which can be created by a file selector in the browser. The methods
				asynchronously return the parsed assets (Using the Promise API). Example:</p>
				<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> file = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"selector"</span>).files[<span class="hljs-number">0</span>];

Title.fromBlob(file).then(<span class="hljs-function"><span class="hljs-params">title</span> =&gt;</span> {
    ...
});
</code></pre>
				<p>The <code>fromArray()</code> (and/or <code>fromArrays()</code>) methods can be used to parse files which are already read into
					<code>Uint8Array</code> objects. Node.js buffers are derived from this data type so it can be used as input as well. The assets
				are returned synchronously. Example:</p>
				<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> data = fs.readFileSync(<span class="hljs-string">"title.pic"</span>);
<span class="hljs-keyword">const</span> title = Title.fromArray(data);
</code></pre>
				<h2 id="web-assets">Web Assets</h2>
				<p>Because of copyright issues you don&#39;t want to include the Wasteland files in your web application and you want to rely
					on the users installation of Wasteland. But this means the user has to select the files in the browser so JavaScript
					can read them. To improve the usability of the library in a web environment wastelib provides a class called
					<code>WebAssets</code>. This class is an asset factory which can be used to store and retrieve all the original Wasteland files in
				the browser by using the <a href="https://developer.mozilla.org/nl/docs/IndexedDB">IndexedDB API</a>.</p>
				<p>The user has to select all the files on the local system once and this selection is a UI specific task and not the
					responsibility of wastelib. But you only need to implement a single callback function for this which then
				asynchronously provides the selected files. Everything else is handled by wastelib.</p>
				<p>Here is a very simplistic example implementation:</p>
				<pre><code class="lang-javascript"><span class="hljs-comment">// This installer callback is only called if files are missing in the database</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">installer</span>(<span class="hljs-params">filenames</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">resolve, reject</span>) </span>{
        <span class="hljs-comment">// Display some UI telling the user to select the Wasteland files with the provided file input element</span>
        <span class="hljs-keyword">var</span> selector = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"input"</span>);
        selector.type = <span class="hljs-string">"file"</span>;
        <span class="hljs-built_in">document</span>.body.appendChild(selector);
        selector.onchange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            <span class="hljs-built_in">document</span>.body.removeChild(selector);
            resolve(<span class="hljs-built_in">Array</span>.prototype.slice.call(selector.files));
        };
    });
}

WebAssets.create(installer).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">assets</span>) </span>{
    assets.readTitle().then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">title</span>) </span>{
        <span class="hljs-comment">// Do something with the title image</span>
    });
    assets.readTilesets().then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tilesets</span>) </span>{
        <span class="hljs-comment">// Do something with the tilesets</span>
    });
    <span class="hljs-comment">// ... and so on ...</span>
});
</code></pre>
				<h2 id="see-also">See also</h2>
				<ul>
					<li><a href="https://github.com/kayahr/wastelib/">GitHub repository</a></li>
					<li><a href="https://www.npmjs.com/package/wastelib/">NPM repository</a></li>
					<li><a href="https://kayahr.github.io/wastelib/api/">API documentation</a></li>
				</ul>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class="globals  ">
						<a href="globals.html"><em>Globals</em></a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
					<li class=" tsd-kind-class tsd-has-type-parameter">
						<a href="classes/baseanimationplayer.html" class="tsd-kind-icon">Base<wbr>Animation<wbr>Player</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/baseimage.html" class="tsd-kind-icon">Base<wbr>Image</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/binaryreader.html" class="tsd-kind-icon">Binary<wbr>Reader</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/cursor.html" class="tsd-kind-icon">Cursor</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/cursors.html" class="tsd-kind-icon">Cursors</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/ending.html" class="tsd-kind-icon">Ending</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/endingframe.html" class="tsd-kind-icon">Ending<wbr>Frame</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/endingpatch.html" class="tsd-kind-icon">Ending<wbr>Patch</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/endingplayer.html" class="tsd-kind-icon">Ending<wbr>Player</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/endingupdate.html" class="tsd-kind-icon">Ending<wbr>Update</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/font.html" class="tsd-kind-icon">Font</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/fontchar.html" class="tsd-kind-icon">Font<wbr>Char</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/picimage.html" class="tsd-kind-icon">Pic<wbr>Image</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/portrait.html" class="tsd-kind-icon">Portrait</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/portraitframe.html" class="tsd-kind-icon">Portrait<wbr>Frame</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/portraitpatch.html" class="tsd-kind-icon">Portrait<wbr>Patch</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/portraitplayer.html" class="tsd-kind-icon">Portrait<wbr>Player</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/portraitscript.html" class="tsd-kind-icon">Portrait<wbr>Script</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/portraitscriptline.html" class="tsd-kind-icon">Portrait<wbr>Script<wbr>Line</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/portraitupdate.html" class="tsd-kind-icon">Portrait<wbr>Update</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/portraits.html" class="tsd-kind-icon">Portraits</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/sprite.html" class="tsd-kind-icon">Sprite</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/sprites.html" class="tsd-kind-icon">Sprites</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/tile.html" class="tsd-kind-icon">Tile</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/tileset.html" class="tsd-kind-icon">Tileset</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/tilesets.html" class="tsd-kind-icon">Tilesets</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/title.html" class="tsd-kind-icon">Title</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/webassets.html" class="tsd-kind-icon">Web<wbr>Assets</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/animation.html" class="tsd-kind-icon">Animation</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/animationplayer.html" class="tsd-kind-icon">Animation<wbr>Player</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="globals.html#wastelandfilename" class="tsd-kind-icon">Wasteland<wbr>Filename</a>
					</li>
					<li class=" tsd-kind-variable">
						<a href="globals.html#color_palette" class="tsd-kind-icon">COLOR_<wbr>PALETTE</a>
					</li>
					<li class=" tsd-kind-variable">
						<a href="globals.html#transparency" class="tsd-kind-icon">TRANSPARENCY</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="globals.html#createcanvas" class="tsd-kind-icon">create<wbr>Canvas</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="globals.html#createimage" class="tsd-kind-icon">create<wbr>Image</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="globals.html#decodehuffman" class="tsd-kind-icon">decode<wbr>Huffman</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="globals.html#decodevxor" class="tsd-kind-icon">decode<wbr>Vxor</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="globals.html#decodevxorinplace" class="tsd-kind-icon">decode<wbr>Vxor<wbr>Inplace</a>
					</li>
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-module"><span class="tsd-kind-icon">Module</span></li>
				<li class="tsd-kind-object-literal"><span class="tsd-kind-icon">Object literal</span></li>
				<li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li>
				<li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li>
				<li class="tsd-kind-function tsd-has-type-parameter"><span class="tsd-kind-icon">Function with type parameter</span></li>
				<li class="tsd-kind-index-signature"><span class="tsd-kind-icon">Index signature</span></li>
				<li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-enum"><span class="tsd-kind-icon">Enumeration</span></li>
				<li class="tsd-kind-enum-member"><span class="tsd-kind-icon">Enumeration member</span></li>
				<li class="tsd-kind-property tsd-parent-kind-enum"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-enum"><span class="tsd-kind-icon">Method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li>
				<li class="tsd-kind-interface tsd-has-type-parameter"><span class="tsd-kind-icon">Interface with type parameter</span></li>
				<li class="tsd-kind-constructor tsd-parent-kind-interface"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-interface"><span class="tsd-kind-icon">Method</span></li>
				<li class="tsd-kind-index-signature tsd-parent-kind-interface"><span class="tsd-kind-icon">Index signature</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
				<li class="tsd-kind-class tsd-has-type-parameter"><span class="tsd-kind-icon">Class with type parameter</span></li>
				<li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class"><span class="tsd-kind-icon">Accessor</span></li>
				<li class="tsd-kind-index-signature tsd-parent-kind-class"><span class="tsd-kind-icon">Index signature</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-constructor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static property</span></li>
				<li class="tsd-kind-call-signature tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static method</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="http://typedoc.io" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
<script>if (location.protocol == 'file:') document.write('<script src="assets/js/search.js"><' + '/script>');</script>
</body>
</html>